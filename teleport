-- Teleport GUI V4 by 33hammm (UI cantik + search + scroll rapi)
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Debris = game:GetService("Debris")

-- GUI
local main = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local CloseBtn = Instance.new("TextButton")
local MinBtn = Instance.new("TextButton")
local SearchBox = Instance.new("TextBox")
local PlayerList = Instance.new("ScrollingFrame")
local Refresh = Instance.new("TextButton")
local Teleport = Instance.new("TextButton")
local UIListLayout = Instance.new("UIListLayout")
local UICorner = Instance.new("UICorner")

main.Name = "TeleportMainV4"
main.Parent = LocalPlayer:WaitForChild("PlayerGui")
main.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
main.ResetOnSpawn = false

-- Frame utama
Frame.Parent = main
Frame.BackgroundColor3 = Color3.fromRGB(35, 40, 60) -- gelap elegan
Frame.Position = UDim2.new(0.1, 0, 0.3, 0)
Frame.Size = UDim2.new(0, 280, 0, 260)
Frame.Active = true
Frame.Draggable = true
Frame.BorderSizePixel = 0
Frame.BackgroundTransparency = 0.05
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = Frame

-- Title bar
Title.Parent = Frame
Title.BackgroundColor3 = Color3.fromRGB(90, 120, 255) -- biru keunguan
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Text = "✨ Teleport GUI V4"
Title.Font = Enum.Font.GothamSemibold
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.TextSize = 16

-- Tombol close
CloseBtn.Parent = Frame
CloseBtn.Text = "✖"
CloseBtn.Size = UDim2.new(0,30,0,30)
CloseBtn.Position = UDim2.new(1,-30,0,0)
CloseBtn.BackgroundColor3 = Color3.fromRGB(255,100,100)
CloseBtn.TextColor3 = Color3.fromRGB(255,255,255)
CloseBtn.Font = Enum.Font.GothamSemibold
CloseBtn.TextSize = 16

-- Tombol minimize
MinBtn.Parent = Frame
MinBtn.Text = "━"
MinBtn.Size = UDim2.new(0,30,0,30)
MinBtn.Position = UDim2.new(1,-60,0,0)
MinBtn.BackgroundColor3 = Color3.fromRGB(255,200,100)
MinBtn.TextColor3 = Color3.fromRGB(50,50,50)
MinBtn.Font = Enum.Font.GothamSemibold
MinBtn.TextSize = 16

local minimized = false
MinBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        for _, child in ipairs(Frame:GetChildren()) do
            if not (child == Title or child == CloseBtn or child == MinBtn) then
                child.Visible = false
            end
        end
        Frame.Size = UDim2.new(0,280,0,30)
    else
        for _, child in ipairs(Frame:GetChildren()) do
            child.Visible = true
        end
        Frame.Size = UDim2.new(0,280,0,260)
    end
end)

-- Search box
SearchBox.Parent = Frame
SearchBox.PlaceholderText = "Search player..."
SearchBox.Position = UDim2.new(0,10,0,40)
SearchBox.Size = UDim2.new(1,-20,0,30)
SearchBox.Font = Enum.Font.Gotham
SearchBox.TextSize = 14
SearchBox.Text = ""
SearchBox.BackgroundColor3 = Color3.fromRGB(230, 235, 240)
SearchBox.TextColor3 = Color3.fromRGB(0,0,0)

-- Player list
PlayerList.Parent = Frame
PlayerList.BackgroundColor3 = Color3.fromRGB(240,240,240)
PlayerList.Position = UDim2.new(0, 10, 0, 80)
PlayerList.Size = UDim2.new(1,-20,0,120)
PlayerList.ScrollBarThickness = 8
PlayerList.CanvasSize = UDim2.new(0,0,0,0)
PlayerList.BorderSizePixel = 1
PlayerList.BorderColor3 = Color3.fromRGB(200,200,200)

UIListLayout.Parent = PlayerList
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0,3)

-- Buttons
Refresh.Parent = Frame
Refresh.BackgroundColor3 = Color3.fromRGB(120, 220, 120)
Refresh.Position = UDim2.new(0, 10, 0, 210)
Refresh.Size = UDim2.new(0.5,-15,0,35)
Refresh.Text = "Refresh"
Refresh.TextScaled = true
Refresh.Font = Enum.Font.GothamBold

Teleport.Parent = Frame
Teleport.BackgroundColor3 = Color3.fromRGB(255, 140, 140)
Teleport.Position = UDim2.new(0.5, 5, 0, 210)
Teleport.Size = UDim2.new(0.5,-15,0,35)
Teleport.Text = "Teleport"
Teleport.TextScaled = true
Teleport.Font = Enum.Font.GothamBold

-- Logic
local selectedPlayer = nil

local function clearList()
    for _,child in ipairs(PlayerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
end

local function refreshList(filter)
    clearList()
    for _,plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            if not filter or string.find(plr.Name:lower(), filter:lower()) then
                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(1, -5, 0, 25)
                btn.Text = plr.Name
                btn.Font = Enum.Font.Gotham
                btn.TextSize = 14
                btn.TextColor3 = Color3.fromRGB(0,0,0)
                btn.BackgroundColor3 = Color3.fromRGB(210, 210, 255)
                btn.Parent = PlayerList
                btn.MouseButton1Click:Connect(function()
                    selectedPlayer = plr
                    for _,b in ipairs(PlayerList:GetChildren()) do
                        if b:IsA("TextButton") then
                            b.BackgroundColor3 = Color3.fromRGB(210,210,255)
                        end
                    end
                    btn.BackgroundColor3 = Color3.fromRGB(255,220,150)
                end)
            end
        end
    end
    PlayerList.CanvasSize = UDim2.new(0,0,0,#PlayerList:GetChildren()*28)
end

SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
    refreshList(SearchBox.Text)
end)

Refresh.MouseButton1Click:Connect(function()
    refreshList(SearchBox.Text)
end)

Teleport.MouseButton1Click:Connect(function()
    if not selectedPlayer then return end
    local myChar = LocalPlayer.Character
    local targetChar = selectedPlayer.Character
    if not myChar or not targetChar then return end

    local myHRP = myChar:FindFirstChild("HumanoidRootPart")
    if not myHRP then return end

    local function getTargetCFrame()
        if targetChar:FindFirstChild("HumanoidRootPart") then
            return targetChar.HumanoidRootPart.CFrame
        elseif targetChar:FindFirstChild("Torso") then
            return targetChar.Torso.CFrame
        elseif targetChar:FindFirstChild("UpperTorso") then
            return targetChar.UpperTorso.CFrame
        else
            return targetChar:GetPivot()
        end
    end

    local targetCFrame = getTargetCFrame()

    -- kalau terlalu jauh, lerp beberapa step
    local distance = (myHRP.Position - targetCFrame.Position).Magnitude
    if distance > 1000 then
        local steps = math.floor(distance / 500)
        for i = 1, steps do
            local direction = (targetCFrame.Position - myHRP.Position).Unit
            myHRP.CFrame = CFrame.new(myHRP.Position + direction * 500)
            task.wait(0.2)
        end
        task.wait(0.5)
        targetCFrame = getTargetCFrame()
    end

    -- posisi final
    local targetPos = targetCFrame.Position + Vector3.new(0,5,0)

    -- Safety ground supaya ga jatoh
    local safetyPart = Instance.new("Part")
    safetyPart.Anchored = true
    safetyPart.Size = Vector3.new(20,1,20)
    safetyPart.CFrame = CFrame.new(targetPos - Vector3.new(0,3,0))
    safetyPart.Transparency = 1
    safetyPart.CanCollide = true
    safetyPart.Parent = workspace

    -- Teleport langsung
    myChar:PivotTo(CFrame.new(targetPos))

    -- Hapus ground setelah 2 detik
    Debris:AddItem(safetyPart, 2)
end)

-- Auto refresh awal
refreshList()
